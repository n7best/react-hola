{"version":3,"file":"index.js","sources":["../src/provider.js","../src/translate.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction mustache(string, data) {\n  let str = string;\n  if (typeof (string) === 'string' && typeof (data) === 'object') {\n    Object.keys(data).forEach((key) => {\n      str = str.replace(new RegExp(`{{\\\\s*${key}\\\\s*}}`, 'g'), data[key]);\n    });\n  }\n  return str;\n}\n\nclass InternationalProvider extends React.Component {\n\n  getChildContext() {\n    return { locale: this.props.locale, getContentByKey: this.getContentByKey.bind(this) };\n  }\n\n  getContentByKey(langKey) {\n    const { locale, data } = this.props;\n\n    if (data[locale]) {\n      if (langKey instanceof Array) {\n        let res = {};\n        langKey.forEach((key) => {\n          res = Object.assign({}, res, this.getSingleContentByKey(data, locale, key));\n        });\n        return res;\n      }\n      return this.getSingleContentByKey(data, locale, langKey);\n    }\n\n    return false;\n  }\n\n  getSingleContentByKey(data, locale, langKey) {\n    // Convert JavaScript string in dot notation into an object reference\n    // https://stackoverflow.com/questions/6393943/convert-javascript-string-in-dot-notation-into-an-object-reference\n    const translations = langKey.split('.').reduce((o, i) => o[i], data[locale]);\n    const res = {};\n    const regMustache = /\\{\\{(.*?)\\}\\}/g;\n\n    if (translations) {\n      // if it's a mastache string return function instead\n      Object.keys(translations).forEach((key) => {\n        const str = translations[key];\n        const matchs = str.match(regMustache);\n        if (matchs) {\n          const fn = strData => mustache(str, strData);\n          res[key] = fn;\n        } else {\n          res[key] = str;\n        }\n      });\n    }\n\n\n    return res;\n  }\n\n  render() {\n    return this.props.children;\n  }\n}\n\nInternationalProvider.defaultProps = {\n  locale: 'en-US',\n  data: {}\n};\n\nInternationalProvider.childContextTypes = {\n  locale: PropTypes.string,\n  getContentByKey: PropTypes.func\n};\n\nexport default InternationalProvider;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nexport default function withTranslation(WrappedComponent, langKey) {\n  function WithTranslation(props, context) {\n    let langs;\n    if (langKey) {\n      langs = context.getContentByKey(langKey);\n    }\n    return (\n      <WrappedComponent\n        {...props}\n        langs={langs}\n        locale={context.locale}\n      />\n    );\n  }\n\n  const wrappedComponentName = WrappedComponent.displayName\n    || WrappedComponent.name\n    || 'Component';\n\n  WithTranslation.displayName = `withTranslation(${wrappedComponentName})`;\n\n  WithTranslation.contextTypes = {\n    locale: PropTypes.string,\n    getContentByKey: PropTypes.func\n  };\n\n  return WithTranslation;\n}\n"],"names":["mustache","string","data","str","keys","forEach","key","replace","RegExp","withTranslation","WrappedComponent","langKey","WithTranslation","props","context","langs","getContentByKey","React","locale","wrappedComponentName","displayName","name","contextTypes","PropTypes","func","InternationalProvider","this","bind","Array","res","Object","assign","_this2","getSingleContentByKey","translations","split","reduce","o","i","regMustache","match","strData","children","Component","defaultProps","childContextTypes"],"mappings":"iGAGA,SAASA,SAASC,EAAQC,OACpBC,EAAMF,QACc,iBAAZA,GAA0C,qBAAVC,sBAAAA,YACnCE,KAAKF,GAAMG,QAAQ,SAACC,KACnBH,EAAII,QAAQ,IAAIC,gBAAgBF,WAAa,KAAMJ,EAAKI,MAG3DH,ECPM,SAASM,gBAAgBC,EAAkBC,YAC/CC,EAAgBC,EAAOC,OAC1BC,gBACAJ,MACMG,EAAQE,gBAAgBL,IAGhCM,oBAACP,cACKG,SACGE,SACCD,EAAQI,cAKhBC,EAAuBT,EAAiBU,aACzCV,EAAiBW,MACjB,qBAEWD,+BAAiCD,QAEjCG,qBACNC,UAAUtB,uBACDsB,UAAUC,MAGtBZ,63CDhBHa,8PAGOP,OAAQQ,KAAKb,MAAMK,OAAQF,gBAAiBU,KAAKV,gBAAgBW,KAAKD,+CAGjEf,gBACWe,KAAKb,MAAtBK,IAAAA,OAAQhB,IAAAA,QAEZA,EAAKgB,GAAS,IACZP,aAAmBiB,MAAO,KACxBC,cACIxB,QAAQ,SAACC,KACTwB,OAAOC,UAAWF,EAAKG,EAAKC,sBAAsB/B,EAAMgB,EAAQZ,MAEjEuB,SAEFH,KAAKO,sBAAsB/B,EAAMgB,EAAQP,UAG3C,gDAGaT,EAAMgB,EAAQP,OAG5BuB,EAAevB,EAAQwB,MAAM,KAAKC,OAAO,SAACC,EAAGC,UAAMD,EAAEC,IAAIpC,EAAKgB,IAC9DW,KACAU,EAAc,wBAEhBL,UAEK9B,KAAK8B,GAAc7B,QAAQ,SAACC,OAC3BH,EAAM+B,EAAa5B,MACVH,EAAIqC,MAAMD,GACb,GAENjC,GADO,mBAAWN,SAASG,EAAKsC,WAGhCnC,GAAOH,IAMV0B,0CAIAH,KAAKb,MAAM6B,gBAjDczB,MAAM0B,WAqD1ClB,sBAAsBmB,qBACZ,iBAIVnB,sBAAsBoB,0BACZtB,UAAUtB,uBACDsB,UAAUC"}